<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>코딩그라운드 정보올림피아드 모의고사</title>
    <style>
        table {
            border-collapse: collapse;
            width: 60%;
          }
          th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
          }
          th {
            background-color: #f2f2f2;
          }
        body { font-family: Arial, sans-serif; line-height: 1.6; }
        h1, h2 { color: #333; }
        pre { background-color: #f4f4f4; padding: 10px; border-radius: 5px; }
        code { font-family: "Courier New", Courier, monospace; }
    </style>
</head>
<body>
    <h1>코딩그라운드 정보올림피아드 모의고사 2교시 1번</h1>
    <A href="https://www.acmicpc.net/submit/33174"> 정답코드 제출 - 백준로그인 필요 </A>
    <hr>
    <h1>당구</h1>

    <h2>문제</h2>
    <p>정올이는 당구를 하고 있다. KOI 국가의 당구는 테이블 위에 나란히 놓인 N개의 공(1, 2, ..., N)을 사용하는 게임이며, </p>
    <p>공은 한번 구멍에 빠지면 다시 테이블 위로 돌아오지 않고 다시 빠뜨릴 수도 없다. 정올이의 목적은 최대한 많은 공을 구멍에 넣는 것이다.</p>

    <p>공을 구멍에 빠뜨리는 것은 집중력을 요하는 작업이다. 처음에 정올이의 집중력은 X이며, i번 공(1 ≦ i ≦ N)을 구멍에 빠뜨리면 집중력이 A<sub>i</sub>만큼 감소한다. </p>    
    <p>집중력이 A<sub>i</sub> 미만일 때는 i번 공을 빠뜨릴 수 없다.</p>    
        
    <p>또한 이 당구 게임에는 공을 빠뜨리는 순서에 관한 규칙이 있다. 구체적으로, P<sub>i</sub> = -1인 경우, i번 공은 언제든지 빠뜨릴 수 있다. </p>    
    <p>P<sub>i</sub> ≠ -1인 경우, i번 공을 빠뜨리려면 먼저 P<sub>i</sub>번 공이 빠져 있어야 한다.</p>
        
    <p>정올이가 가진 집중력과 각 공의 정보가 주어졌을 때, 정올이가 공을 구멍에 빠뜨릴 수 있는지 판단하고, 빠뜨릴 수 있는 공 중 번호가 가장 큰 것을 출력하는 프로그램을 작성하시오.</p>
    <p>단, 공을 하나도 빠뜨릴 수 없다면 -1을 출력한다.</p>

    <h2>입력</h2>
    <p>입력은 다음 형식으로 주어진다.</p>
    <pre><code>
    N X
    A<sub>1</sub> A<sub>2</sub> ... A<sub>N</sub> 
    P<sub>1</sub> P<sub>2</sub> ... P<sub>N</sub>
    </code></pre>


    <h2>출력</h2>
    <p>정올이가 구멍에 빠뜨릴 수 있는 공 번호의 최댓값을 1행에 출력한다. 단, 하나도 빠뜨릴 수 없는 경우 -1을 출력한다.</p>

    <h2>제약조건</h2>
    <ul>
        <li>1 ≦ N ≦ 200000</li>
        <li>1 ≦ X ≦ 10<sup>15</sup> </li>
        <li>1 ≦ A<sub>i</sub> ≦ 10<sup>9</sup> (1 ≦ i ≦ N)  </li>
        <li>1 ≦ P<sub>i</sub> ≦ N 또는 P<sub>i</sub> = -1 (1 ≦ i ≦ N)  </li>
        <li>P<sub>i</sub> ≠ i (1 ≦ i ≦ N)  </li>
        <li>입력되는 값은 모두 정수이다.</li>
    </ul>

    <h2>부분 문제</h2>
    <table>
        <thead>
          <tr>
            <th>번호</th>
            <th>배점</th>
            <th>제한</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>6</td>
            <td>N ≦ 1000, P<sub>i</sub> = -1  </td>
          </tr>
          <tr>
            <td>2</td>
            <td>9</td>
            <td>N ≦ 1000, P<sub>i</sub> = -1 또는 P<sub>i</sub> = i-1  </td>
          </tr>
          <tr>
            <td>3</td>
            <td>16</td>
            <td>N ≦ 1000, P<sub>i</sub> < i</td>
          </tr>
          <tr>
            <td>4</td>
            <td>20</td>
            <td>P<sub>i</sub> < i  </td>
          </tr>
          <tr>
            <td>5</td>
            <td>19</td>
            <td>N ≦ 1000  </td>
          </tr>
          <tr>
            <td>6</td>
            <td>30</td>
            <td>추가 제약 없음  </td>
          </tr>
        </tbody>
      </table>
    <hr>
    <h2>예제 입력 1</h2>
    <pre><code>
    6 7
    1 2 4 3 10 100
    -1 -1 -1 -1 -1 -1
    </code></pre>

    <h2>예제 출력 1</h2>
    <pre><code>
    4
    </code></pre>

    <p>처음에, 정올이의 집중력은 7이다.</p>

    <p>모든 i (1 ≦ i ≦ N)에 대해 P<sub>i</sub> = -1이므로, 정올이는 집중력이 충분한 한 모든 공을 언제든지 구멍에 넣을 수 있다.</p>

    <p>예를 들어, 다음과 같이 하면 정올이는 공 4를 넣을 수 있다.</p>

    <p>먼저, 공 3을 구멍에 넣는다. 정올이의 집중력이 4 감소하여 남은 집중력은 3이 된다.</p>
    <p>다음으로, 공 4를 구멍에 넣는다. 정올이의 집중력이 3 감소하여 남은 집중력은 0이 된다.</p>
    <p>또한, 정올이는 공 5와 6을 구멍에 넣을 수 없다.</p>
    <p>따라서, 정올이가 구멍에 넣을 수 있는 공 번호의 최댓값은 4이다.</p>

    <p>이 입력 예시는 부분문제 1, 3, 4, 5, 6의 제한을 만족한다.</p>

    <hr>
    <h2>예제 입력 2</h2>
    <pre><code>
    5 12
    1 2 3 5 8
    -1 1 2 3 4
    </code></pre>

    <h2>예제 출력 2</h2>
    <pre><code>
    4
    </code></pre>

    <p>처음에, 정올이의 집중력은 12이다.</p>

    <p>예를 들어, 다음과 같이 하면 정올이는 공 4를 구멍에 넣을 수 있다.</p>

    <p>먼저, 공 1을 구멍에 넣는다. (<span>P<sub>1</sub></span> = -1이므로 공 1은 언제든지 넣을 수 있다.)</p>
    <p>정올이의 집중력이 1 감소하여 남은 집중력은 11이 된다.</p>
    <p>다음으로, 공 2를 구멍에 넣는다. (<span>P<sub>2</sub></span> = 1이고 공 1은 이미 넣었기 때문에 공 2를 넣을 수 있다.)</p>
    <p>정올이의 집중력이 2 감소하여 남은 집중력은 9가 된다.</p>
    <p>다음으로, 공 3을 구멍에 넣는다. (<span>P<sub>3</sub></span> = 2이고 공 2는 이미 넣었기 때문에 공 3을 넣을 수 있다.)</p>
    <p>정올이의 집중력이 3 감소하여 남은 집중력은 6이 된다.</p>
    <p>다음으로, 공 4를 구멍에 넣는다. (<span>P<sub>4</sub></span> = 3이고 공 3은 이미 넣었기 때문에 공 4를 넣을 수 있다.)</p>
    <p>정올이의 집중력이 5 감소하여 남은 집중력은 1이 된다.</p>
    <p>또한, 정올이는 공 5를 구멍에 넣을 수 없다.</p>
    <p>따라서, 정올이가 구멍에 넣을 수 있는 공 번호의 최댓값은 4이다.</p>

    <p>이 입력 예시는 부분문제 2, 3, 4, 5, 6의 제한을 만족한다.</p>

    <hr>
    <h2>예제 입력 3</h2>
    <pre><code>
    8 10
    3 1 4 1 5 9 2 6
    -1 1 2 -1 4 4 5 7
    </code></pre>

    <h2>예제 출력 3</h2>
    <pre><code>
    7
    </code></pre>
    <p>이 입력 예시는 부분문제 3, 4, 5, 6의 제한을 만족한다.</p>
    <hr>
    <h2>예제 입력 4</h2>
    <pre><code>
    2 1000000000000000
    1 1
    2 1
    </code></pre>

    <h2>예제 출력 4</h2>
    <pre><code>
    -1
    </code></pre>
    
    <p>P<sub>1</sub> = 2이므로, 공 1을 넣기 위해서는 공 2가 이미 구멍에 들어가 있어야 한다.</p>
    <p>반대로, P<sub>2</sub> = 1이므로, 공 2를 넣기 위해서는 공 1이 이미 구멍에 들어가 있어야 한다.</p>
    <p>이로 인해 정올이는 공을 하나도 넣을 수 없다.</p>
    <p>따라서 -1을 출력한다.</p>
    <p>이 입력 예시는 부분문제 5, 6의 제한을 만족한다.</p>

    <hr>

    <h2>예제 입력 5</h2>
    <pre><code>
    9 2468024680
    123456789 234567891 345678912 456789123 567891234 678912345 789123456 891234567 912345678
    6 5 4 -1 3 2 1 9 8
    </code></pre>

    <h2>예제 출력 5</h2>
    <pre><code>
    6
    </code></pre>
    <p>이 입력 예시는 부분문제 5, 6의 제한을 만족한다.</p>
</body>
</html>